<!DOCTYPE html>
<html>

<head>
  <title>K6 Stress Test Chart</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      width: 90vw;;
      margin: auto;
    }
    .chart-container {
      position: relative;
      width: 100%;
      height: 50vh;
      min-height: 480px;
    }
    span.msg {
      font-weight: bold; color: brown;
    }
    span.times {
      font-size: 1.2em; color: #333;
    }
    #testTime {
      font-size: 1.2em; color: #333; text-align: right; margin-right: 12px;
    }
  </style>
</head>

<body>
  <div>
    <h2>Stress Test</h2>
    <div id="testTime"></div>
  </div>
  <div class="chart-container">
    <canvas id="myChart"></canvas>
  </div>
  <ul id="errList">
  </ul>
  <script>
    function drawChart(data) {
      const chart = new Chart(document.getElementById('myChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: data.datasets
        },
        options: {
          animation: true,
          maintainAspectRatio: false,
          scales: {
            y3: { position: 'left', stack: 'left', stackWeight: 1, offset: true, min: 0, max: 11, title: { display: true, text: 'Pod nums' } },
            y1: { position: 'left', stack: 'left', stackWeight: 2, offset: true, title: { display: true, text: 'users CPU mCores' } },
            y2: { position: 'left', stack: 'left', stackWeight: 2, offset: true, title: { display: true, text: 'orders CPU mCores' } },
            // y2: { position: 'left', stack: 'left', stackWeight: 2, offset: true, title: { display: true, text: 'MiB' } },
          }
        }
      });
    }
    function listErrors(errors) {
      const ul = document.getElementById('errList');
      const stats = {};
      errors.forEach(e => {
        const [time, msg] = e.split('\t');
        const key = msg.replace(/tcp ([\d.]+):(\d+)->/, "tcp $1:*->")
        if (stats[key]) {
          stats[key].push(time);
        } else {
          stats[key] = [time];
        }
      });
      Object.keys(stats).forEach(msg => {
        const li = document.createElement('li');
        li.innerHTML = `<span class=msg>${msg}</span><br /><span class=times>${stats[msg].join(',')}</span>`;
        ul.appendChild(li);
      });
    }
    function setChartTitle(title, testTime) {
      document.title = title;
      document.querySelector('h2').innerText = title;
      document.getElementById('testTime').innerText = testTime;
    }
  </script>
  <script>setChartTitle("Stress Test Report - 9/6/2023, 12:24:56 AM", "9/5/2023, 11:52:11 PM");
let data={"labels":["-1:59:52","-1:59:53","-1:59:54","-1:59:55","-1:59:56","-1:59:57","-1:59:58","-1:59:59","00:00:00","00:00:01","00:00:02","00:00:03","00:00:04","00:00:05","00:00:06","00:00:07","00:00:08","00:00:09","00:00:10","00:00:11","00:00:12","00:00:13","00:00:14","00:00:15","00:00:16","00:00:17","00:00:18","00:00:19","00:00:20","00:00:21","00:00:22","00:00:23","00:00:24","00:00:25","00:00:26","00:00:27","00:00:28","00:00:29","00:00:30","00:00:31","00:00:32","00:00:33","00:00:34","00:00:35","00:00:36","00:00:37","00:00:38","00:00:39","00:00:40","00:00:41","00:00:42","00:00:43","00:00:44","00:00:45","00:00:46","00:00:47","00:00:48","00:00:49","00:00:50","00:00:51","00:00:52","00:00:53","00:00:54","00:00:55","00:00:56","00:00:57","00:00:58","00:00:59","00:01:00","00:01:01","00:01:02","00:01:03","00:01:04","00:01:05","00:01:06","00:01:07","00:01:08","00:01:09","00:01:10","00:01:11","00:01:12","00:01:13","00:01:14","00:01:15","00:01:16","00:01:17","00:01:18","00:01:19","00:01:20","00:01:21","00:01:22","00:01:23","00:01:24","00:01:25","00:01:26","00:01:27","00:01:28","00:01:29","00:01:30","00:01:31","00:01:32","00:01:33","00:01:34","00:01:35","00:01:36","00:01:37","00:01:38","00:01:39","00:01:40","00:01:41","00:01:42","00:01:43","00:01:44","00:01:45","00:01:46","00:01:47","00:01:48","00:01:49","00:01:50","00:01:51","00:01:52","00:01:53","00:01:54","00:01:55","00:01:56","00:01:57","00:01:59","00:02:00","00:02:01","00:02:02","00:02:03","00:02:04","00:02:05","00:02:06","00:02:07","00:02:08","00:02:09","00:02:10","00:02:11"],"datasets":[{"label":"Pod nums","data":[7,7,7,7,7,7,7,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11],"borderColor":"lightgray","yAxisID":"y3","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":true,"borderWidth":2,"lineType":"line"},{"label":"orders-v1-68b798b5cd-46pt2-CPU","data":[17.7,17.7,17.7,17.7,17.7,17.7,17.7,17.7,17.7,17.7,17.7,15.95,15.95,15.95,15.95,15.95,15.95,15.95,15.95,15.95,15.95,15.95,15.95,15.95,15.95,15.95,71.48,71.48,71.48,71.48,71.48,71.48,71.48,71.48,71.48,71.48,71.48,71.48,71.48,71.48,71.48,110.26,110.26,110.26,110.26,110.26,110.26,110.26,110.26,110.26,110.26,110.26,110.26,110.26,110.26,110.26,114.37,114.37,114.37,114.37,114.37,114.37,114.37,114.37,114.37,114.37,114.37,114.37,114.37,114.37,114.37,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,126.13,126.13,126.13,126.13,126.13,126.13,126.13,126.13,126.13,126.13,126.13,126.13,126.13,126.13,126.13,124.03,124.03,124.03,124.03,124.03,124.03,124.03,124.03,124.03,124.03,124.03,124.03,124.03,124.03,124.03,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91,122.91],"borderColor":"orange","yAxisID":"y2","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"},{"label":"orders-v1-68b798b5cd-s4tbj-CPU","data":[20.2,20.2,20.2,20.2,20.2,20.2,20.2,20.2,20.2,20.2,20.2,11.91,11.91,11.91,11.91,11.91,11.91,11.91,11.91,11.91,11.91,11.91,11.91,11.91,11.91,11.91,60.32,60.32,60.32,60.32,60.32,60.32,60.32,60.32,60.32,60.32,60.32,60.32,60.32,60.32,60.32,105.46,105.46,105.46,105.46,105.46,105.46,105.46,105.46,105.46,105.46,105.46,105.46,105.46,105.46,105.46,147.01,147.01,147.01,147.01,147.01,147.01,147.01,147.01,147.01,147.01,147.01,147.01,147.01,147.01,147.01,243.35,243.35,243.35,243.35,243.35,243.35,243.35,243.35,243.35,243.35,243.35,243.35,243.35,243.35,243.35,289.36,289.36,289.36,289.36,289.36,289.36,289.36,289.36,289.36,289.36,289.36,289.36,289.36,289.36,289.36,289.55,289.55,289.55,289.55,289.55,289.55,289.55,289.55,289.55,289.55,289.55,289.55,289.55,289.55,289.55,297.18,297.18,297.18,297.18,297.18,297.18,297.18,297.18,297.18,297.18,297.18,297.18,297.18,297.18,297.18,296.83,296.83,296.83,296.83,296.83,296.83,296.83,296.83],"borderColor":"green","yAxisID":"y2","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"},{"label":"users-v1-687bcd44cf-ct62p-CPU","data":[17.94,17.94,17.94,17.94,17.94,17.94,17.94],"borderColor":"#93FF93","yAxisID":"y1","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"},{"label":"users-v1-687bcd44cf-mvm2p-CPU","data":[15.79,15.79,15.79,15.79,15.79,15.79,15.79,15.79,15.79,15.79,15.79,15.52,15.52,15.52,15.52,15.52,15.52,15.52,15.52,15.52,15.52,15.52,15.52,15.52,15.52,15.52,97.57,97.57,97.57,97.57,97.57,97.57,97.57,97.57,97.57,97.57,97.57,97.57,97.57,97.57,97.57,272.13,272.13,272.13,272.13,272.13,272.13,272.13,272.13,272.13,272.13,272.13,272.13,272.13,272.13,272.13,302.54,302.54,302.54,302.54,302.54,302.54,302.54,302.54,302.54,302.54,302.54,302.54,302.54,302.54,302.54,298.98,298.98,298.98,298.98,298.98,298.98,298.98,298.98,298.98,298.98,298.98,298.98,298.98,298.98,298.98,305.23,305.23,305.23,305.23,305.23,305.23,305.23,305.23,305.23,305.23,305.23,305.23,305.23,305.23,305.23,302.35,302.35,302.35,302.35,302.35,302.35,302.35,302.35,302.35,302.35,302.35,302.35,302.35,302.35,302.35,302.76,302.76,302.76,302.76,302.76,302.76,302.76,302.76,302.76,302.76,302.76,302.76,302.76,302.76,302.76,291.7,291.7,291.7,291.7,291.7,291.7,291.7,291.7],"borderColor":"#9393FF","yAxisID":"y1","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"},{"label":"users-v1-687bcd44cf-vk88c-CPU","data":[17.23,17.23,17.23,17.23,17.23,17.23,17.23,17.23,17.23,17.23,17.23,12.03,12.03,12.03,12.03,12.03,12.03,12.03,12.03,12.03,12.03,12.03,12.03,12.03,12.03,12.03,129.32,129.32,129.32,129.32,129.32,129.32,129.32,129.32,129.32,129.32,129.32,129.32,129.32,129.32,129.32,285.87,285.87,285.87,285.87,285.87,285.87,285.87,285.87,285.87,285.87,285.87,285.87,285.87,285.87,285.87,298.22,298.22,298.22,298.22,298.22,298.22,298.22,298.22,298.22,298.22,298.22,298.22,298.22,298.22,298.22,297.37,297.37,297.37,297.37,297.37,297.37,297.37,297.37,297.37,297.37,297.37,297.37,297.37,297.37,297.37,294.71,294.71,294.71,294.71,294.71,294.71,294.71,294.71,294.71,294.71,294.71,294.71,294.71,294.71,294.71,299.76,299.76,299.76,299.76,299.76,299.76,299.76,299.76,299.76,299.76,299.76,299.76,299.76,299.76,299.76,298.41,298.41,298.41,298.41,298.41,298.41,298.41,298.41,298.41,298.41,298.41,298.41,298.41,298.41,298.41,274.27,274.27,274.27,274.27,274.27,274.27,274.27,274.27],"borderColor":"#4DFFFF","yAxisID":"y1","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"},{"label":"users-v1-687bcd44cf-kts4c-CPU","data":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,294.69,294.69,294.69,294.69,294.69,294.69,294.69,294.69,294.69,294.69,294.69,294.69,294.69,294.69,294.69,307.43,307.43,307.43,307.43,307.43,307.43,307.43,307.43,307.43,307.43,307.43,307.43,307.43,307.43,307.43,293.07,293.07,293.07,293.07,293.07,293.07,293.07,293.07,293.07,293.07,293.07,293.07,293.07,293.07,293.07,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,295.01,293.01,293.01,293.01,293.01,293.01,293.01,293.01,293.01,293.01,293.01,293.01,293.01,293.01,293.01,293.01,258.06,258.06,258.06,258.06,258.06,258.06,258.06,258.06],"borderColor":"#467500","yAxisID":"y1","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"},{"label":"users-v1-687bcd44cf-hm9lm-CPU","data":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,256.55,256.55,256.55,256.55,256.55,256.55,256.55,256.55,256.55,256.55,256.55,256.55,256.55,256.55,256.55,277.9,277.9,277.9,277.9,277.9,277.9,277.9,277.9,277.9,277.9,277.9,277.9,277.9,277.9,277.9,281.87,281.87,281.87,281.87,281.87,281.87,281.87,281.87,281.87,281.87,281.87,281.87,281.87,281.87,281.87,272.65,272.65,272.65,272.65,272.65,272.65,272.65,272.65,272.65,272.65,272.65,272.65,272.65,272.65,272.65,283.87,283.87,283.87,283.87,283.87,283.87,283.87,283.87,283.87,283.87,283.87,283.87,283.87,283.87,283.87,238.15,238.15,238.15,238.15,238.15,238.15,238.15,238.15],"borderColor":"#737300","yAxisID":"y1","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"},{"label":"users-v1-687bcd44cf-qf7bf-CPU","data":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,270.24,270.24,270.24,270.24,270.24,270.24,270.24,270.24,270.24,270.24,270.24,270.24,270.24,270.24,270.24,273.5,273.5,273.5,273.5,273.5,273.5,273.5,273.5,273.5,273.5,273.5,273.5,273.5,273.5,273.5,288.19,288.19,288.19,288.19,288.19,288.19,288.19,288.19,288.19,288.19,288.19,288.19,288.19,288.19,288.19,283.33,283.33,283.33,283.33,283.33,283.33,283.33,283.33,283.33,283.33,283.33,283.33,283.33,283.33,283.33,290.93,290.93,290.93,290.93,290.93,290.93,290.93,290.93,290.93,290.93,290.93,290.93,290.93,290.93,290.93,283.15,283.15,283.15,283.15,283.15,283.15,283.15,283.15],"borderColor":"#BB5E00","yAxisID":"y1","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"},{"label":"orders-v1-68b798b5cd-v8ksf-CPU","data":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,120.45,120.45,120.45,120.45,120.45,120.45,120.45,120.45,120.45,120.45,120.45,120.45,120.45,120.45,120.45,89.42,89.42,89.42,89.42,89.42,89.42,89.42,89.42,89.42,89.42,89.42,89.42,89.42,89.42,89.42,11.25,11.25,11.25,11.25,11.25,11.25,11.25,11.25,11.25,11.25,11.25,11.25,11.25,11.25,11.25,9.23,9.23,9.23,9.23,9.23,9.23,9.23,9.23,9.23,9.23,9.23,9.23,9.23,9.23,9.23,10.95,10.95,10.95,10.95,10.95,10.95,10.95,10.95],"borderColor":"#B87070","yAxisID":"y2","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"},{"label":"orders-v1-68b798b5cd-29nb4-CPU","data":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,151.13,151.13,151.13,151.13,151.13,151.13,151.13,151.13,151.13,151.13,151.13,151.13,151.13,151.13,151.13,8.7,8.7,8.7,8.7,8.7,8.7,8.7,8.7,8.7,8.7,8.7,8.7,8.7,8.7,8.7,10.18,10.18,10.18,10.18,10.18,10.18,10.18,10.18,10.18,10.18,10.18,10.18,10.18,10.18,10.18,9.53,9.53,9.53,9.53,9.53,9.53,9.53,9.53],"borderColor":"#6FB7B7","yAxisID":"y2","backgroundColor":"rgba(0,0,0,0.1)","pointRadius":0,"fill":false,"borderWidth":2,"lineType":"line"}]};drawChart(data);
let errors=[];listErrors(errors);
</script>

</body>

</html>
